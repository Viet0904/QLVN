@using Microsoft.JSInterop
@inject IJSRuntime JSRuntime

<div id="styleSelector" class="@(_isOpen ? "open" : "")">
    <div class="selector-toggle">
        <a href="javascript:void(0)" @onclick="ToggleSelector"></a>
    </div>
    <ul>
        <li>
            <p class="selector-title main-title st-main-title"><b>Adminty </b>Customizer</p>
            <span class="text-muted">Live customizer with tons of options</span>
        </li>
        <li>
            <p class="selector-title">Main layouts</p>
        </li>
        <li>
            <div class="theme-color">
                <a href="javascript:void(0)" class="navbar-theme" @onclick='() => SetTheme("navbar", "themelight1")' navbar-theme="themelight1">
                    <span class="head"></span><span class="cont"></span>
                </a>
                <a href="javascript:void(0)" class="navbar-theme" @onclick='() => SetTheme("navbar", "theme1")' navbar-theme="theme1">
                    <span class="head"></span><span class="cont"></span>
                </a>
            </div>
        </li>
    </ul>

    <div class="style-cont m-t-10" style="height: calc(100vh - 440px); overflow-y: auto;">
        <ul class="nav nav-tabs tabs" role="tablist">
            <li class="nav-item">
                <a class="nav-link @(_activeTab == "layout" ? "active" : "")" @onclick='() => _activeTab = "layout"'>Layouts</a>
            </li>
            <li class="nav-item">
                <a class="nav-link @(_activeTab == "sidebar" ? "active" : "")" @onclick='() => _activeTab = "sidebar"'>Sidebar Settings</a>
            </li>
        </ul>

        <div class="tab-content tabs">
            @if (_activeTab == "layout")
            {
                <div class="tab-pane active" role="tabpanel">
                    <ul>
                        <li class="theme-option">
                            <div class="checkbox-fade fade-in-primary">
                                <label>
                                    <input type="checkbox" id="sidebar-position" checked="@_isSidebarFixed" @onchange="ToggleSidebarPosition">
                                    <span class="cr"><i class="cr-icon feather icon-check txt-success f-w-600"></i></span>
                                    <span>Fixed Sidebar Position</span>
                                </label>
                            </div>
                        </li>
                        <li class="theme-option">
                            <div class="checkbox-fade fade-in-primary">
                                <label>
                                    <input type="checkbox" id="header-position" checked="@_isHeaderFixed" @onchange="ToggleHeaderPosition">
                                    <span class="cr"><i class="cr-icon feather icon-check txt-success f-w-600"></i></span>
                                    <span>Fixed Header Position</span>
                                </label>
                            </div>
                        </li>
                    </ul>
                </div>
            }
            else
            {
                <div class="tab-pane active" role="tabpanel">
                    <ul>
                        <li class="theme-option">
                            <p class="sub-title drp-title">SideBar Effect</p>
                            <select id="vertical-menu-effect" class="form-control minimal" @onchange='(e) => UpdateSelect("vertical-menu-effect", e)'>
                                <option value="shrink">shrink</option>
                                <option value="overlay">overlay</option>
                                <option value="push">Push</option>
                            </select>
                        </li>
                        <li class="theme-option">
                            <p class="sub-title drp-title">Hide/Show Border</p>
                            <select id="vertical-border-style" class="form-control minimal" @onchange='(e) => UpdateSelect("vertical-border-style", e)'>
                                <option value="solid">Style 1</option>
                                <option value="dotted">Style 2</option>
                                <option value="dashed">Style 3</option>
                                <option value="none">No Border</option>
                            </select>
                        </li>
                        <li class="theme-option">
                            <p class="sub-title drp-title">Drop-Down Icon</p>
                            <select id="vertical-dropdown-icon" class="form-control minimal" @onchange='(e) => UpdateSelect("vertical-dropdown-icon", e)'>
                                <option value="style1">Style 1</option>
                                <option value="style2">Style 2</option>
                                <option value="style3">Style 3</option>
                            </select>
                        </li>
                        <li class="theme-option">
                            <p class="sub-title drp-title">Sub Menu Drop-Down Icon</p>
                            <select id="vertical-subitem-icon" class="form-control minimal" @onchange='(e) => UpdateSelect("vertical-subitem-icon", e)'>
                                <option value="style1">Style 1</option>
                                <option value="style2">Style 2</option>
                                <option value="style3">Style 3</option>
                                <option value="style4">Style 4</option>
                                <option value="style5">Style 5</option>
                                <option value="style6">Style 6</option>
                            </select>
                        </li>
                    </ul>
                </div>
            }
        </div>
    </div>
</div>

@code {
    private bool _isOpen = false;
    private string _activeTab = "layout";
    private bool _isSidebarFixed = true;
    private bool _isHeaderFixed = true;

    private void ToggleSelector() => _isOpen = !_isOpen;

    private async Task SetTheme(string type, string value) =>
        await JSRuntime.InvokeVoidAsync("adminThemeBridge.setTheme", type, value);

    private async Task ToggleSidebarPosition(ChangeEventArgs e)
    {
        _isSidebarFixed = (bool)e.Value!;
        await JSRuntime.InvokeVoidAsync("adminThemeBridge.setSidebarPosition", _isSidebarFixed);
    }

    private async Task ToggleHeaderPosition(ChangeEventArgs e)
    {
        _isHeaderFixed = (bool)e.Value!;
        await JSRuntime.InvokeVoidAsync("adminThemeBridge.setHeaderPosition", _isHeaderFixed);
    }

    private async Task UpdateSelect(string id, ChangeEventArgs e) =>
        await JSRuntime.InvokeVoidAsync("adminThemeBridge.setSelectOption", id, e.Value?.ToString());
}